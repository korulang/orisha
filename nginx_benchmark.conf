worker_processes auto;  # Use all cores
daemon off;
error_log /dev/null;

events {
    worker_connections 1024;
    use kqueue;
}

http {
    access_log off;

    # TCP optimizations
    tcp_nodelay on;
    tcp_nopush on;

    # File serving optimizations
    sendfile on;

    # File descriptor cache
    open_file_cache max=1000 inactive=20s;
    open_file_cache_valid 30s;
    open_file_cache_min_uses 2;
    open_file_cache_errors on;

    server {
        listen 3001;

        location / {
            root /Users/larsde/src/orisha/src/public;
            index index.html;
        }

        location /about {
            alias /Users/larsde/src/orisha/src/public/about.html;
        }

        location /api/health {
            return 200 'OK';
            add_header Content-Type application/json;
        }
    }
}
